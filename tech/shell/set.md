# set 命令

## 作用
默认显示全部shell变量（包括shell内置变量和用户变量），除非遇到非法选项，否则总是返回0
可以设置现存shell变量的新值，但不能定义新的shell变量（定义使用declare，也可以省略）

设置的flag保存在变量 `$-` 中

option之外的参数被赋值到位置参数（`$1`, `$2`, ...）中

### 设置环境
#### 返回检查
```
set -e
```
设置之后，一旦每条语句出现非0，整个脚本立即退出（不再执行后续语句）（相当于在每条语句后加上 `|| exit $?`）
上面是简写法，完整的写法是：
```
set -o errexit
```

##### 忽略返回值
```
set +e
```
慎用，相当于每条语句后加上`|| true`。

#### 管道命令的返回值
```
set -o pipefail
```
包含管道命令的语句的返回值，会变成最后一个返回非零的管道命令的返回值（而不是管道最后一条命令的返回值）；但管道后面的命令依然会执行完。

#### 变量初始化
```
set -u
```
使用未初始化的变量脚本会立即退出
上面是简写法，完整的写法是：
```
set -o nounset
```


## 类比
set显示全部shell变量（其中shell内置变量因所用shell不同而不同）（直接定义的变量都是shell变量）
env显示当前用户变量（和所用的shell无关）
export显示当前导出为用户变量的shell变量

declare定义一个新的变量（可省略）
readonly定义一个只读变量
local定义一个局部变量

unset销毁一个变量（只读变量不行）

